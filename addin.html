# Strip out the automatic fetch() attempt and keep only the Geotab-safe manual upload version

geotab_safe_html = html_content.replace(
    '''// Auto-load CSV from local path (if hosted in same directory)
                    fetch("RUC Project.csv")
                        .then(response => response.text())
                        .then(csvText => {
                            try {
                                rucData = parseCSV(csvText);
                                console.log('Auto-loaded CSV:', rucData);
                                processRucData();
                            } catch (error) {
                                console.error('Auto-load CSV parse error:', error);
                                showError('Error loading CSV file: ' + error.message);
                            }
                        })
                        .catch(err => {
                            console.error('Error fetching CSV:', err);
                            showError('Failed to fetch CSV file: ' + err.message);
                        });''',
    ''  # Remove the whole fetch block for Geotab-safe use
)

# Save the cleaned version
geotab_safe_path = Path("/mnt/data/ruc_addin_geotab_safe.html")
geotab_safe_path.write_text(geotab_safe_html)

geotab_safe_path.name
